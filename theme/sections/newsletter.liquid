{%- comment -%}
This file contains eve's newsletter section, migrated from the legacy eve codebase
Dawn's default Email Signup section can now be found at `theme/sections/newsletter-dawn`

The markup migrated below previously used helper classes from eve's legacy theme, Impulse.
These classes have been removed and replaced with a `section-newsletter.css`. The src of
this stylesheet can be found at `src/styles/section/newsletter.scss`.
{%- endcomment -%}

<link rel="stylesheet" href="{{ 'section-newsletter.css' | asset_url }}" media="print" onload="this.media='all'">
<noscript>{{ 'section-newsletter.css' | asset_url | stylesheet_tag }}</noscript>

{{ 'component-form.css' | asset_url | stylesheet_tag }}

{% style %}
  .newsletter-{{ section.id }} {
    {%- comment -%}
      background-color: {{ section.settings.color_background }};
      color: {{ section.settings.color_text }};
    {%- endcomment -%} 
    padding:35px 0;
    border-top: 1px solid #ccc;
  }
  .newsletter-{{ section.id }}.newsletter-section--style-1 { background-color: #FFFFFF;}
  .newsletter-{{ section.id }}.newsletter-section--style-2 { background-color: #FFC533;}
  .newsletter-{{ section.id }}.newsletter-section--style-1 .footer-signup button[type="submit"] { background: #FFC533;}
  .newsletter-{{ section.id }}.newsletter-section--style-2 .footer-signup button[type="submit"] { background: #FFFFFF !important; border: 1px solid #949494;}
  .newsletter-{{ section.id }}.newsletter-section--style-2 .js-content.is-loaded.has-success {background: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNzUycHQiIGhlaWdodD0iNzUycHQiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDc1MiA3NTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiA8cGF0aCBkPSJtMzYxLjQzIDQ5OS4yNS0xMDcuNjktODEuNjg0Yy00LjQ0OTItMy4zNzExLTcuMzc1LTguMzc1LTguMTM2Ny0xMy45MDYtMC43NTc4MS01LjUzMTIgMC43MDcwMy0xMS4xNDEgNC4wODItMTUuNTlzOC4zNzg5LTcuMzc1IDEzLjkxLTguMTM2N2M1LjUzMTItMC43NTc4MSAxMS4xMzcgMC43MTA5NCAxNS41ODYgNC4wODJsNzIuMDM1IDU0LjY1MiAxMTEuNTUtMTY3LjMzaDAuMDAzOTA3YzMuMDgyLTQuNjc1OCA3LjkwMjMtNy45MzM2IDEzLjM5MS05LjA0NjkgNS40OTIyLTEuMTA5NCAxMS4xOTkgMC4wMTE3MTkgMTUuODU5IDMuMTE3MiA0LjY2MDIgMy4xMDk0IDcuODkwNiA3Ljk0NTMgOC45NzI3IDEzLjQ0MSAxLjA4NTkgNS40OTYxLTAuMDY2NDA2IDExLjE5NS0zLjE5OTIgMTUuODR6IiBmaWxsPSIjZmZmIi8+Cjwvc3ZnPgo=") no-repeat left center; background-size: 46px;}

  .newsletter-{{ section.id }} .newsletter__input::-webkit-input-placeholder { color: {{ section.settings.color_text }}; }
  .newsletter-{{ section.id }} .newsletter__input::-moz-placeholder { color: {{ section.settings.color_text }}; }
  .newsletter-{{ section.id }} .newsletter__input::-ms-input-placeholder { color: {{ section.settings.color_text }}; }
  /* new lines  */
  /* .newsletter-{{ section.id }} .footer-signup{ margin-left: 1rem; } */
  .newsletter-{{ section.id }} .flex-grid{ align-items:center;}
  .newsletter-{{ section.id }} .form--condensed .form-field{ margin-bottom:0; }
  .newsletter-{{ section.id }} .form-field--icon-button .form-field__input { width: calc(100% - 9.6rem - 1rem); } /* Minus an extra rem for margin */
  .newsletter-{{ section.id }} .footer-signup button[type="submit"] { background: {{ section.settings.button_background }} !important; color: #000; width: 9.6rem; border: 0 none; position: absolute; min-width: 9.6rem; }
  .newsletter-{{ section.id }} .footer-signup button[type="submit"].btn--loading .btn__text{ opacity:0; display:none; visibility: hidden; }
  .newsletter-{{ section.id }} .js-content.is-loaded.has-success {justify-content: center; align-items: center; display: inline-flex; }
  .newsletter-{{ section.id }} .form--ometria { display: flex; flex-direction: column; justify-content: flex-start;}
  .newsletter-{{ section.id }} .js-content.is-loaded.has-success {padding-left: 4.8rem; background: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNzUycHQiIGhlaWdodD0iNzUycHQiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDc1MiA3NTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiA8cGF0aCBkPSJtMzYxLjQzIDQ5OS4yNS0xMDcuNjktODEuNjg0Yy00LjQ0OTItMy4zNzExLTcuMzc1LTguMzc1LTguMTM2Ny0xMy45MDYtMC43NTc4MS01LjUzMTIgMC43MDcwMy0xMS4xNDEgNC4wODItMTUuNTlzOC4zNzg5LTcuMzc1IDEzLjkxLTguMTM2N2M1LjUzMTItMC43NTc4MSAxMS4xMzcgMC43MTA5NCAxNS41ODYgNC4wODJsNzIuMDM1IDU0LjY1MiAxMTEuNTUtMTY3LjMzaDAuMDAzOTA3YzMuMDgyLTQuNjc1OCA3LjkwMjMtNy45MzM2IDEzLjM5MS05LjA0NjkgNS40OTIyLTEuMTA5NCAxMS4xOTkgMC4wMTE3MTkgMTUuODU5IDMuMTE3MiA0LjY2MDIgMy4xMDk0IDcuODkwNiA3Ljk0NTMgOC45NzI3IDEzLjQ0MSAxLjA4NTkgNS40OTYxLTAuMDY2NDA2IDExLjE5NS0zLjE5OTIgMTUuODR6IiBmaWxsPSIjZmZjZTAwIi8+Cjwvc3ZnPgo=") no-repeat left center; background-size: 46px;}

  .newsletter-{{ section.id }} .footer-signup.js-footer-signup .js-content.is-loaded.has-success + .rte.medium-up--hide,
  .newsletter-{{ section.id }} .footer-signup.js-footer-signup .js-content.is-loaded.has-success .medium-up--hide {
    display: none;
  }

  .newsletter-{{ section.id }} .footer-signup.js-footer-signup .js-content.is-loaded.has-success .small--hide {
    display: block;
  }

  .newsletter-{{ section.id }} .btn {
    margin-bottom: 1.6rem;
  }

  .newsletter-{{ section.id }} .success-copy p {
    margin: 0;
  }

  @media only screen and (max-width: 749px){
    .newsletter-{{ section.id }} {
      text-align: center;
    }
    .newsletter-{{ section.id }} .h3 {
      margin-bottom: 1.6rem;
    }
    .newsletter-{{ section.id }} .form-field--icon-button .form-field__input {
      width: 100%;
      margin-bottom: 1.6rem;
    }
    .newsletter-{{ section.id }} .footer-signup button[type="submit"] {
      position: static;
      width: 100%;
      transform: translateY(0);
      min-width: 9.6rem;
    }
    .newsletter-{{ section.id }} .footer-signup.js-footer-signup .js-content.is-loaded.has-success + .rte.medium-up--hide,
    .newsletter-{{ section.id }} .footer-signup.js-footer-signup .js-content.is-loaded.has-success .medium-up--hide {
      display: block;
    }

    .newsletter-{{ section.id }} .footer-signup.js-footer-signup .js-content.is-loaded.has-success .small--hide {
      display: none;
    }

    .newsletter-{{ section.id }}.newsletter-section--style-1 .js-content.is-loaded.has-success,
    .newsletter-{{ section.id }}.newsletter-section--style-2 .js-content.is-loaded.has-success {
      padding-left: 0 !important;
      padding-bottom: 5rem;
      background-position: center bottom;
      background-size: 60px;
    }
    .grid--no-gutters.newsletter-form-container.has-success .h3.desktop-heading {
      display: none;
      visibility: hidden;
      opacity: 0;
    }

    .newsletter-{{ section.id }}.newsletter-form-container.has-success .newsletter-section__text {
      display: none;
      visibility: hidden;
      opacity: 0;
    }
  }
{% endstyle %}

<div class="newsletter-section newsletter-form-container newsletter-{{ section.id }}{% if section.settings.color_background == settings.color_body_bg %} newsletter-section--with-divider{% endif %} newsletter-section--{{ section.settings.select_style }}">
  <div class="page-width newsletter-section__inner">
      <div class="newsletter-section__text">
        {% if section.settings.title != blank %}
          <h3 class="h2 newsletter-section__heading">{{ section.settings.title | escape }}</h3>
        {% endif %}
        {% if section.settings.text != blank %}
          <div class="rte newsletter-section__text newsletter-section__text--desktop">{{ section.settings.text }}</div>
        {% endif %}
      </div>
      <div class="footer-signup js-footer-signup">
        <div class="js-content"></div> 
        {% if section.settings.text != blank %}
          <div class="rte newsletter-section__text newsletter-section__text--mobile">{{ section.settings.text }}</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<script>
  contextualise('footerSignup', {
    formUID: {{ section.id | json }},
    ometriaBucket: {{ section.settings.ometria_bucket | json }},
  });
</script>

<script src="{{ 'section-newsletter.js' | asset_url }}" defer="defer"></script>

{% schema %}
  {
    "name": "Newsletter",
    "settings": [
      {
        "type": "paragraph",
        "content": "Customers who subscribe will have their email address added to the 'accepts marketing' [customer list](/admin/customers?query=&accepts_marketing=1)."
      },
      {
        "type": "text",
        "id": "title",
        "label": "Heading",
        "default": "Sign up and save"
      },
      {
        "type": "richtext",
        "id": "text",
        "label": "Subheading",
        "default": "<p>Subscribe to get special offers, free giveaways, and once-in-a-lifetime deals.</p>"
      },
      {
        "type": "select", 
        "id": "select_style",
        "label": "Change Newsletter Style",
        "default": "style-1",
        "options": [
          {
            "value": "style-1",
            "label": "Style 1"
          },
          {
            "value": "style-2",
            "label": "Style 2"
          }
        ]
      },
      {
      "type": "text",
      "label": "Ometria bucket",
      "id": "ometria_bucket"
      }
    ],
    "presets": [
      {
        "name": "Newsletter",
        "category": "Promotional"
      }
    ]
  }
{% endschema %}
